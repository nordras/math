{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/projetos/math/lib/cache/exerciseCache.js"],"sourcesContent":["/**\r\n * Cache em memória para exercícios gerados\r\n * Usa Map para armazenar temporariamente os exercícios\r\n */\r\n\r\nclass ExerciseCache {\r\n  constructor() {\r\n    this.cache = new Map();\r\n  }\r\n\r\n  /**\r\n   * Salva um exercício no cache\r\n   * @param {string} id - ID único do exercício\r\n   * @param {object} data - Dados do exercício\r\n   */\r\n  set(id, data) {\r\n    this.cache.set(id, {\r\n      data,\r\n      timestamp: Date.now(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Busca um exercício do cache\r\n   * @param {string} id - ID único do exercício\r\n   * @returns {object|null} - Dados do exercício ou null\r\n   */\r\n  get(id) {\r\n    const entry = this.cache.get(id);\r\n    if (!entry) {\r\n      return null;\r\n    }\r\n\r\n    const ONE_HOUR = 60 * 60 * 1000;\r\n    if (Date.now() - entry.timestamp > ONE_HOUR) {\r\n      this.cache.delete(id);\r\n      return null;\r\n    }\r\n\r\n    return entry.data;\r\n  }\r\n\r\n  /**\r\n   * Remove um exercício do cache\r\n   * @param {string} id - ID único do exercício\r\n   */\r\n  delete(id) {\r\n    this.cache.delete(id);\r\n  }\r\n\r\n  /**\r\n   * Limpa todos os exercícios expirados\r\n   */\r\n  cleanup() {\r\n    const ONE_HOUR = 60 * 60 * 1000;\r\n    const now = Date.now();\r\n\r\n    for (const [id, entry] of this.cache.entries()) {\r\n      if (now - entry.timestamp > ONE_HOUR) {\r\n        this.cache.delete(id);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retorna estatísticas do cache\r\n   */\r\n  getStats() {\r\n    return {\r\n      size: this.cache.size,\r\n      keys: Array.from(this.cache.keys()),\r\n    };\r\n  }\r\n}\r\n\r\n// Singleton usando global para persistir durante hot reload\r\nconst globalForCache = global;\r\n\r\nexport function getExerciseCache() {\r\n  if (!globalForCache.__exerciseCache) {\r\n    globalForCache.__exerciseCache = new ExerciseCache();\r\n    \r\n    // Cleanup automático a cada 30 minutos\r\n    setInterval(() => {\r\n      globalForCache.__exerciseCache.cleanup();\r\n    }, 30 * 60 * 1000);\r\n  }\r\n  return globalForCache.__exerciseCache;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;CAGC,GAED,MAAM;IACJ,aAAc;QACZ,IAAI,CAAC,KAAK,GAAG,IAAI;IACnB;IAEA;;;;GAIC,GACD,IAAI,EAAE,EAAE,IAAI,EAAE;QACZ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI;YACjB;YACA,WAAW,KAAK,GAAG;QACrB;IACF;IAEA;;;;GAIC,GACD,IAAI,EAAE,EAAE;QACN,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QAC7B,IAAI,CAAC,OAAO;YACV,OAAO;QACT;QAEA,MAAM,WAAW,KAAK,KAAK;QAC3B,IAAI,KAAK,GAAG,KAAK,MAAM,SAAS,GAAG,UAAU;YAC3C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;YAClB,OAAO;QACT;QAEA,OAAO,MAAM,IAAI;IACnB;IAEA;;;GAGC,GACD,OAAO,EAAE,EAAE;QACT,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;IACpB;IAEA;;GAEC,GACD,UAAU;QACR,MAAM,WAAW,KAAK,KAAK;QAC3B,MAAM,MAAM,KAAK,GAAG;QAEpB,KAAK,MAAM,CAAC,IAAI,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,GAAI;YAC9C,IAAI,MAAM,MAAM,SAAS,GAAG,UAAU;gBACpC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;YACpB;QACF;IACF;IAEA;;GAEC,GACD,WAAW;QACT,OAAO;YACL,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI;YACrB,MAAM,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI;QAClC;IACF;AACF;AAEA,4DAA4D;AAC5D,MAAM;AAEC,SAAS;IACd,IAAI,CAAC,eAAe,eAAe,EAAE;QACnC,eAAe,eAAe,GAAG,IAAI;QAErC,uCAAuC;QACvC,YAAY;YACV,eAAe,eAAe,CAAC,OAAO;QACxC,GAAG,KAAK,KAAK;IACf;IACA,OAAO,eAAe,eAAe;AACvC"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":["file:///C:/projetos/math/app/exercise/%5Bid%5D/page.tsx"],"sourcesContent":["import { notFound } from 'next/navigation';\r\nimport { getExerciseCache } from '@/lib/cache/exerciseCache';\r\n\r\ninterface PageProps {\r\n  params: Promise<{\r\n    id: string;\r\n  }>;\r\n}\r\n\r\nexport default async function ExercisePage({ params }: PageProps) {\r\n  const { id } = await params;\r\n  const cache = getExerciseCache();\r\n  \r\n  const exercise = cache.get(id);\r\n\r\n  if (!exercise) {\r\n    notFound();\r\n  }\r\n\r\n  // Retornar o HTML puro\r\n  return (\r\n    <div dangerouslySetInnerHTML={{ __html: exercise.html }} />\r\n  );\r\n}\r\n\r\n// Metadados dinâmicos\r\nexport async function generateMetadata({ params }: PageProps) {\r\n  const { id } = await params;\r\n  const cache = getExerciseCache();\r\n  const exercise = cache.get(id);\r\n\r\n  if (!exercise) {\r\n    return {\r\n      title: 'Exercício não encontrado',\r\n    };\r\n  }\r\n\r\n  const typeLabel = exercise.type === 'grid' ? 'Grade' : 'Contextualizado';\r\n  return {\r\n    title: `Exercício ${typeLabel} - Gerador de Matemática`,\r\n    description: `Exercício de matemática com ${exercise.stats.total} problemas`,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA;AAAA;AACA;;;;AAQe,eAAe,aAAa,EAAE,MAAM,EAAa;IAC9D,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,QAAQ,IAAA,iJAAgB;IAE9B,MAAM,WAAW,MAAM,GAAG,CAAC;IAE3B,IAAI,CAAC,UAAU;QACb,IAAA,iMAAQ;IACV;IAEA,uBAAuB;IACvB,qBACE,8OAAC;QAAI,yBAAyB;YAAE,QAAQ,SAAS,IAAI;QAAC;;;;;;AAE1D;AAGO,eAAe,iBAAiB,EAAE,MAAM,EAAa;IAC1D,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,QAAQ,IAAA,iJAAgB;IAC9B,MAAM,WAAW,MAAM,GAAG,CAAC;IAE3B,IAAI,CAAC,UAAU;QACb,OAAO;YACL,OAAO;QACT;IACF;IAEA,MAAM,YAAY,SAAS,IAAI,KAAK,SAAS,UAAU;IACvD,OAAO;QACL,OAAO,CAAC,UAAU,EAAE,UAAU,wBAAwB,CAAC;QACvD,aAAa,CAAC,4BAA4B,EAAE,SAAS,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC;IAC9E;AACF"}}]
}